%% BioMed_Central_Tex_Template_v1.06
%%                                      %
%  bmc_article.tex            ver: 1.06 %
%                                       %

%%IMPORTANT: do not delete the first line of this template
%%It must be present to enable the BMC Submission system to 
%%recognise this template!!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                     %%
%%  LaTeX template for BioMed Central  %%
%%     journal article submissions     %%
%%                                     %%
%%         <14 August 2007>            %%
%%                                     %%
%%                                     %%
%% Uses:                               %%
%% cite.sty, url.sty, bmc_article.cls  %%
%% ifthen.sty. multicol.sty		   %%
%%				      	   %%
%%                                     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%	
%% For instructions on how to fill out this Tex template           %%
%% document please refer to Readme.pdf and the instructions for    %%
%% authors page on the biomed central website                      %%
%% http://www.biomedcentral.com/info/authors/                      %%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%% BioMed Central currently use the MikTex distribution of         %%
%% TeX for Windows) of TeX and LaTeX.  This is available from      %%
%% http://www.miktex.org                                           %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\documentclass[10pt]{bmc_article}    



% Load packages
\usepackage{cite} % Make references as [1-4], not [1,2,3,4]
\usepackage{url}  % Formatting web addresses  
\usepackage{ifthen}  % Conditional 
\usepackage{multicol}   %Columns
\usepackage[utf8]{inputenc} %unicode support
%\usepackage[applemac]{inputenc} %applemac support if unicode package fails
%\usepackage[latin1]{inputenc} %UNIX support if unicode package fails
\urlstyle{rm}
\usepackage{nameref}
 
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%	
%%                                             %%
%%  If you wish to display your graphics for   %%
%%  your own use using includegraphic or       %%
%%  includegraphics, then comment out the      %%
%%  following two lines of code.               %%   
%%  NB: These line *must* be included when     %%
%%  submitting to BMC.                         %% 
%%  All figure files must be submitted as      %%
%%  separate graphics through the BMC          %%
%%  submission process, not included in the    %% 
%%  submitted article.                         %% 
%%                                             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                     


\def\includegraphic{}
\def\includegraphics{}



\setlength{\topmargin}{0.0cm}
\setlength{\textheight}{21.5cm}
\setlength{\oddsidemargin}{0cm} 
\setlength{\textwidth}{16.5cm}
\setlength{\columnsep}{0.6cm}

\newboolean{publ}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                              %%
%% You may change the following style settings  %%
%% Should you wish to format your article       %%
%% in a publication style for printing out and  %%
%% sharing with colleagues, but ensure that     %%
%% before submitting to BMC that the style is   %%
%% returned to the Review style setting.        %%
%%                                              %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 

%Review style settings
%\newenvironment{bmcformat}{\begin{raggedright}\baselineskip20pt\sloppy\setboolean{publ}{false}}{\end{raggedright}\baselineskip20pt\sloppy}

%Publication style settings
%\newenvironment{bmcformat}{\fussy\setboolean{publ}{true}}{\fussy}

%New style setting
\newenvironment{bmcformat}{\baselineskip20pt\sloppy\setboolean{publ}{false}}{\baselineskip20pt\sloppy}

% Begin ...
\begin{document}
\begin{bmcformat}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the title of your article here     %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% TODO: come up with a better title, or at least a subtitle?

\title{Structure-based classification and ontology in chemistry}
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the authors here                   %%
%%                                          %%
%% Ensure \and is entered between all but   %%
%% the last two authors. This will be       %%
%% replaced by a comma in the final article %%
%%                                          %%
%% Ensure there are no trailing spaces at   %% 
%% the ends of the lines                    %%     	
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\author{Janna Hastings\correspondingauthor$^1,^2$%
         \email{Janna Hastings\correspondingauthor - hastings@ebi.ac.uk}
       \and 
         Despoina Magka$^3$%
         \email{despoina.magka@lincoln.ox.ac.uk}%  logics
       \and 
         Lian Duan$^1$%
         \email{dlian@ebi.ac.uk} %  chemoinformatics
       \and 
         Robert Stevens$^4$  % chemistry, ontology technology
         \email{robert.stevens@manchester.ac.uk}%
       \and 
         Marcus Ennis$^1$ % chebi
         \email{mennis@ebi.ac.uk}        
       and 
       	 Christoph Steinbeck$^1$%
         \email{steinbeck@ebi.ac.uk}%
      }
      

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the authors' addresses here        %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\address{%
    \iid(1)Chemoinformatics and Metabolism, European Bioinformatics Institute, Hinxton, UK\\
    \iid(2)Swiss Center for Affective Sciences, University of Geneva, Switzerland\\
    \iid(3)Oxford University Computing Lab, Oxford, UK\\
    \iid(4)Manchester University, UK%\\
}%

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The Abstract begins here                 %%
%%                                          %%  
%% Please refer to the Instructions for     %%
%% authors on http://www.biomedcentral.com  %%
%% and include the section headings         %%
%% accordingly for your article type.       %%   
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{abstract}
        % Do not use inserted blank lines (ie \\) until main body of text.
Recent years have seen an explosion in the availability of data in the chemistry domain. With this information explosion, however, retrieving \textit{relevant} results from the deluge of available information, and \textit{organising} those results, become ever harder problems. Computational processing is essential to filter and organise the available resources so as to better facilitate the work of scientists. Ontologies encode expert domain knowledge in a hierarchically organised computable format. One such ontology for the chemical domain is ChEBI. ChEBI provides a classification based on structural features and a role or activity-based classification. An example of a structure-based class is `pentacyclic compound' (compounds containing five-ring structures), while an example of a role-based class is `analgesic', since many different chemicals can act as analgesics without sharing structural features. 

Structure-based classification in chemistry exploits elegant regularities and symmetries in the underlying chemical domain.  Some of these regularities lead easily to automated approaches to classification, and indeed hierarchical organisation through clustering or scaffolding are well developed in chemoinformatics.  Logical definition of chemical classes in ontologies allows automated reasoning to detect class membership and manage hierarchies automatically.  Some relevant and interesting chemical classes cannot yet adequately be automated.  In this paper, we describe several categories of structural classification in chemistry.  We compare these patterns of class definition to tools which allow for automation of hierarchy construction within chemoinformatics and within chemical ontology.  Finally we discuss the relationships between chemoinformatics approaches and logic-based approaches. 

Systems which perform intelligent reasoning tasks need to rely on a diverse set of underlying computational utilities including algorithmic, statistical and logic-based tools.  For the task of automatic structure-based classification of chemical entities, essential to managing the vast swathes of chemical data being brought online, systems which are capable of hybrid reasoning combining several different approaches are crucial.  

\end{abstract}



\ifthenelse{\boolean{publ}}{\begin{multicols}{2}}{}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The Main Body begins here                %%
%%                                          %%
%% Please refer to the instructions for     %%
%% authors on:                              %%
%% http://www.biomedcentral.com/info/authors%%
%% and include the section headings         %%
%% accordingly for your article type.       %% 
%%                                          %%
%% See the Results and Discussion section   %%
%% for details on how to create sub-sections%%
%%                                          %%
%% use \cite{...} to cite references        %%
%%  \cite{koon} and                         %%
%%  \cite{oreg,khar,zvai,xjon,schn,pond}    %%
%%  \nocite{smith,marg,hunn,advi,koha,mouse}%%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%%%%
%% Background %%
%%
\section*{Background}

Recent years have seen an explosion in the availability of data throughout the natural sciences. Primary data facilitates research through complex data-mining and knowledge discovery methods. However, with this information explosion, retrieving \textit{relevant} information from the deluge has become much more difficult. Computational processing is essential to filter, retrieve and organise such data. These goals are facilitated by \textit{formal ontologies}: computable encodings of human domain knowledge. These ontologies are used in several different ways \cite{lambrix2004}: to provide standardisation of terminology and identification across all entities in a domain so that multiple sources of data can be aggregated through comparable reference terms, to provide hierarchical organisation so that such aggregation can be performed at different levels and data can be browsed in an easily accessible fashion, and to allow for logic-based intelligent applications to be built which are able to perform complex reasoning tasks such as checking for errors and inconsistencies and deriving logical inferences. Logic-based knowledge representation (of which ontology is a particular kind) can be contrasted with algorithmic ``knowledge" representation, in which software algorithms procedurally define outputs based on stated inputs, and with statistical ``knowledge" representation, in which complex statistical models are trained to produce outputs based on a given set of inputs by learning weights for a complex set of internal parameters.  The advantages of logic-based knowledge representation is that it allows the knowledge to be expressed \textit{as knowledge}, i.e. as statements which are easily comprehensible, true and self-contained.  Statistical methods operate as black boxes and procedural methods require a programmer in order to manipulate or extend. 

One example of a successful ontology in the biomedical domain is the Gene Ontology \cite{go2000}, which is used \textit{inter alia} for the statistical analysis of large-scale genetic data to identify genes which are significantly enriched for specific functions.  For the domain of biologically interesting chemistry, the Chemical Entities of Biological Interest ontology (ChEBI) \cite{chebi2010} provides a classification of chemical entities such as atoms, molecules and ions.  ChEBI organises chemical entities according to shared structural features, for example, carboxylic acids are all molecular entities that possess the characteristic carboxy group, and according to their activities in biological and chemical contexts, for example, acting as an antiviral agent. ChEBI is widely used as a database of chemical entities which can be queried both by structural classes and by functional annotations in the role ontology. The ontology has been applied in diverse applications such as annotation of chemicals in biological databases for pathways, interactions, and systems biology models \cite{matthews2009,libiomodels2010,kerrien2007}; chemical text mining \cite{corbett2006}; formalising the chemistry underlying biological ontologies \cite{mungall2010}; semantic similarity \cite{couto2011}; and metabolome prediction \cite{swainston2010}. Like the GO, ChEBI is manually maintained by a team of expert curators.  Historically, bio-ontologies such as GO and ChEBI have been developed as Directed Acyclic Graphs (DAGs), a deliberately simplified ontology format which allowed domain experts (non-logicians) to directly participate in ontology engineering. However, with the increasing availability of supporting tools and widespread adoption, there is a growing trend of evolution  towards the Web standard ontology language OWL \cite{owlformat}, which provides a sophisticated suite of logic-based constructs to support eloquent knowledge representation and automated reasoning in real-world domains \cite{alterovitz2010}. 

Structure-based classification in chemistry exploits elegant regularities and symmetries in the underlying chemical domain.  Some of these regularities lead easily to algorithmic or statistical automated approaches to classification, and as a result, algorithmic approaches to hierarchical organisation of large-scale compound collections is a mature research area in chemoinformatics \cite{barnard1992,deshpande2005}. However, there are nevertheless several key benefits to adoption of the ontology-based approach in the chemistry domain, namely:
\begin{itemize}
	\item Classification knowledge represented in an ontology is \textit{explicit}, while algorithms which perform hierarchical classification often act as \textit{black boxes}, and to change the classification requires changes to the underlying software;
	\item Representation of chemical knowledge in an ontology allows it to be harnessed in a generic fashion from within diverse knowledge-based applications which also utilize knowledge from \textit{other domains} (a core requirement for whole-scale systems biology), while to make use of chemoinformatics algorithms and toolkits requires custom software, differing from the software used in other domains; and
	\item There are several types of chemical class which are not adequately represented in algorithmic approaches, which can be formalised in 
\end{itemize}

Conversely, there are several benefits to adopting chemoinformatics tools within the ontology engineering process in the domain of chemistry, such as to benefit from the well-developed and rapid algorithms for detecting parthood between chemicals and computing properties.  In this paper, we present an analysis of the types of structure-based classes used in chemistry, and then discuss these as compared to available chemoinformatics algorithms for computing hierarchical ordering on sets of compounds and to the available constructions for encoding class definitions in chemical ontologies based on OWL.  We then explore aspects of chemoinformatics tools which we believe can enhance chemical ontology and explore problem areas in common to both fields which we believe can provide a stimulus for future research bridging the domains of chemoinformatics and computational logic. 

The remainder of this paper is organised as follows. The remainder of this Background presents some relevant chemoinformatics and ontology concepts.  Following that, we firstly present the types of classes used in chemical classification and thereafter discuss these types of classes in the context of chemoinformatics hierarchy construction methods in chemoinformatics and in the context of what can be stated and reasoned over in chemical ontologies. In our Discussion, we discuss the relationship between chemoinformatics and logical approaches and some applications of chemical ontology.  We conclude with our outlook and open research areas. 



\subsection*{Classification in chemistry}
\label{sec:backclassif}

The ability to \textit{classify} raw information into meaningful groups is an essential component of human intelligence, which thus far has proven difficult to replicate in machine reasoning.  In particular, classification has a long tradition in chemistry:  the periodic table of the elements is one of the longest-standing and most used systems of classification throughout the natural sciences.  

The importance of classification systems are severalfold. 

Classification \textit{organises} large volumes of information into sensible groupings so that they are more accessible to humans. Such hierarchical organisations can be more easily browsed; research in cognitive science shows that humans can only browse and compare a relatively low number of concepts at the same level at the same time, thus grouping into hierarchies reduces the amount of detail that has to be dealt with at each level \cite{sternberg2003}. A hierarchical structure allows narrowing in on the area of interest within a large domain, and only exploring the details of that narrowed in area, rather than observing the full domain at such a detailed level.
 
A second benefit of a hierarchical organisation is that it allows for the compact representation of generalised knowledge at the highest level to which it applies.  For example, statements which are true for all mammals need to be expressed at the level of mammals as a whole, and not repeated for every specific mammal that occurs downstream.  Similarly, features which apply to all carboxylic acids can be expressed at the level of carboxylic acids as a whole. 

Hierarchical organisation of knowledge in a domain allows for data-driven discovery, enabling useful predictions to be made.  For example, in functional genomics, the analysis of large-scale genetic data is facilitated by the grouping together of different genes which perform the same function, and modular analysis of such datasets reveals organisation at an aggregate level which is not apparent at the level of the details. Hierarchical organisation of knowledge also allows useful predictions to be made, since it allows generalisation of knowledge to the highest possible level of applicability, and consequent prediction of properties of novel discovered members of the class.  Chemical classes, the objects found within a chemical classification system, group together chemical entities in such a way as to allow meaningful scientifically relevant groups to be created and described. Ideally, all members of a chemical class should share important dispositional properties such as chemical reactivity. In fact, almost the only method of classification which was available to historical chemists, before compound structures were well understood, was based on the observation of reactivity through means of performing controlled reactions between different substances, or based on the origin of the molecule where the molecule was isolated from a natural product substance. Much of these historical forms of classification are still inherited today and are taught in chemistry classes and reproduced in textbooks. Knowledge about the structural features which form the underlying \textit{causes} of the shared dispositional properties (where such existed), and the structural features shared between similar natural product substances, was only developed later. However, now that chemical structures are well described (within the limits of the chemical graph formalism), many more structural features are able to be used for chemical class definitions. 

As previously mentioned, interesting classes in chemistry can be grouped into those which are \textit{structure-based} and those which are not. Structure-based classes are defined based on the presence of some shared structural feature across all members of the class.  This feature, however, may be crisply defined or vaguely defined.  

Vaguely defined structural classes:  steroids, other family-resemblance classes (structural similarity?)
Crisply defined structural classes:  carboxylic acids and the others... discussed further in section xxx below. 

Other types of classes used in chemistry:  %(Marcus to help out here?)
Classes defined based on where the chemical came from:  natural product classes / metabolic products.  Also contrast the two different types of polymer naming conventions. 
Classes defined based on what the chemical does in a biological or chemical context: e.g. antibiotic, acid, solvent, such-and-such a drug, blah \cite{batchelor2011}. %Re: certain types of uncertainty in class definitions in terms of contextual information, perhaps can cite Bio-ontologies and OWLED papers, in the Discussion where the need for hybrid systems for knowledge representation are discussed. 
% Can also cite collections based on 

Hybrid classes:  tricyclic antidepressant; tetracyclic antibiotic and so on...

The relationship between structure and function (SARs; but also cliffs in structure-activity space)

The focus in the remainder of this document will be on crisply defined structure-based classes in chemistry, which will be discussed further in the section \textit{\nameref{sec:resultsclasses}} below. %below

% Review on algorithm based chemical classification. Need to be relocated

Since computers are introduced to chemistry research. Chemical structures are formalized as graph in computer systems, and most classification algorithms can not deal with such graphical data. In order to apply classification algorithms, molecular descriptors are calculated. As defined by Todeschini and Consonni\cite{Todeschini2000}, the molecular descriptor is the final result of a logic and mathematical procedure which transforms chemical information encoded within a symbolic representation of a molecule into a useful number or the result of some standardized experiment. Among calculated descriptors, if we focus on structural features, molecular fingerprint is a special form of descriptors which is defined as a string of boolean value, which each bit represent a feature. In the most common types of fingerprint, a feature could be either a pre-defined substructure or a random substructure mapped by hashing algorithms.

Structure-activity relation(SAR) study is one of the hottest field where classification algorithms are applied. Supervised machine learning methods like Bayesian classifier, decision trees and support vector machine, etc. are employed to classify compounds into positive or negative class. The classification problem we are discussing here is to organize chemical structures in an understandable way. As mentioned above, hierarchical organization is crucial for easier human understanding. But none of those supervised methods mentioned above has the ability to extract such a hierarchical structure. Supervised machine learning require a reasonable training set of chemicals which are already classified. Although existing database like ChEBI and MeSH could act as training set, the size of such data is still a tiny fraction of the enormous chemical space. And what's make the problem more challenging is that the leaf nodes of such classification tree normally contains few structures. 

Other statistical methods like hierarchical clustering\cite{Adamson1981} do give a hierarchy. In general, hierarchical clustering rely on a similarity distance matrix, composed by pair-wise distance. Either agglomerative or divisive methods could be used. In an agglomerative clustering, all instances are assigned to its own class initially. Then a recursive merge is performed. In each step, two nearest class are chosen to be merged, until all classes are merged into one. Divisive clustering are performed in an opposite manner, which all instances are in one class initially and split instead of merging is done in each recursive step.

In the hierarchical tree constructed by clustering analysis, the each node represent a class. However, the meaning of such nodes is unclear. And changes in input data(or structures) can result in different hierarchical tree, making it more difficult to formalize the class definition. 

Maximum common structure(MCS) based clustering and scaffold tree are more promising in presenting intermediate node in hierarchy tree. 

LibraryMCS\cite{librarymcs} is a commercial application that can perform MCS based clustering on a set of structures. There's no technical details of the underlying implementation available, but it could be easily observed from the output that structures shares common substructure are organized in same class, and the common substructures define the scopes of each class. Scaffold tree\cite{Schuffenhauer2007} is a hierarchal classification of scaffolds(molecular frameworks which is obtained by removing terminal side chains). By removing rings in scaffolds recursively, scaffolds are decomposed into smaller ones which form the higher levels in hierarchy tree. 

Both MCS or scaffold based methods are very helpful in visualizing and giving an overview of the dataset. In the hierarchy tree output, a clear representation could be extracted, as either a MCS or a scaffold, and then to be used as class presentation. But the output is highly dependent on the input, thus could not act as a universal chemical classification. 


% This is a background section. 
\subsection*{Logic-based reasoning and ontology}
\label{sec:backlogic}

%  DESPOINA TO HELP WITH THIS SECTION
 
Ontologies are usually expressed in a logic-based language which allows automated inferences from the expressed knowledge using computational logic-based reasoning.  Logic-based reasoning relies on logical deduction in order to compute inferences.  In order for this to work, expressed knowledge must be generally true, that is, it must be expressed in terms of what is true for all members of a given class. 

Forms of logical inference: 
\begin{itemize}
	\item  classification
	\item  transitive closure
	\item  checking for errors
	\item  managing instances
\end{itemize}

Of central importance when building large scale ontologies which need to be consumed by practical applications is that the underlying logical formalism is \textit{decidable}: that is, that it is possible to prove that complex reasoning tasks on ontologies expressed in that formalism can be performed in finite time.  The need for decidable formalisms for large-scale terminological knowledge resources has been the driving force behind the development of Description Logics (DLs), a family of logical expression languages which have well understood properties and which allow for combinations of different sorts of definitional statements when building a knowledge base.  The ontology language which is a widely adopted W3C standard for representation of ontologies, the Web Ontology Language (OWL), is based on DLs, and this is the language in which ontologies such as ChEBI and GO are expressed. However, in the general case, chemical structures -- graphs of atoms connected by bonds -- are unable to be expressed directly in this language, as they are highly cyclic structured objects, and inclusion of such structured objects at the class level would render the underlying language undecidable.   
 
OWL is based on Description Logics (DLs), and different profiles of OWL correspond to different underlying DLs.  A powerful feature of such DLs, and therefore OWL, is the ability to perform \textit{automatic classification} based on \textit{full class definitions}.  A full class definition is specified in terms of necessary and sufficient conditions for class membership, and these conditions are then used to check the knowledge base for classes which match those conditions, \ldots

The Web Ontology Language (OWL) grew out of the need to formalise the semantics of RDF data in the context of the Semantic Web.  The latest released version of OWL is OWL 2, which includes an expanded range of features relative to the first version, such as more advanced handling of data values and ranges. OWL 2 has different \textit{profiles}, each of which contains a selected set of features and constructs to optimise performance a given task.  For example, the OWL EL (expression language) profile is optimised for rapid classification time (polynomial), while the OWL RL (rule language) profile allows interaction between terms in the ontology and a set of decision-like rules.   

Like DLs, OWL is assigned an \textit{open world} semantics, which means that inferences can only be drawn based on what is explicitly captured in the ontology. The open world assumption is that what is not explicitly stated in the ontology is \textit{not known}, rather than \textit{known not to be}, thus other shapes may exist that have not been specified. However, certain operators allow us to ``close the world'' under certain conditions, by creating \textit{closure axioms}. 

One of the prevailing challenges in chemical ontology is the representation of complex chemical structures in the underlying formalism. Cyclic structures prove particularly challenging for logic-based representation \cite{magka2010}.  

Why cycles are a problem \ldots


%% ANY OTHER LOGIC BACKGROUND NEEDED for the remainder of the paper?


\section*{Results}

\subsection*{Types of structure-based chemical classes}
\label{sec:resultsclasses}

The chemical graph formalism \cite{trinajstic1992} allows the description of fully defined chemical classes at a certain level of granularity, for example, the class of all paracetamol molecules.  Paracetamol molecules all have in common the connectivity as described in the graph describing the class, but individual molecules vary in conformation and configuration depending on their environmental context. The chemical graph formalism, however, only applies to fully defined chemical structures, and there are limited extensions to support higher-level modelling (such as R groups). 

There are many different types of classes that are used in chemistry, for various reasons of historical development and usefulness. New classes are both created and discovered, as research in natural chemistry and biochemistry reveals new information, so too synthetic chemists are able to create ever more complex and creative structures.

Some of the elements which are used in chemical class definition include: 
\begin{enumerate}
	\item Atomic composition
	\item Basic chemical properties, such as charge
	\item Cycles and ring system arrangements
	\item Interesting parts
	\item Structural formulae
\end{enumerate}

Most of these elements can be used singly or in combination with other elements.  Further explanations as well as examples follow in the sections below. 

\subsubsection*{Atomic composition}

Classes may be defined based on the presence of certain types of atoms, organised according to the layout of the periodic table.  Figure~\ref{fig:periodic-table} shows the ChEBI interface for browsing molecular entities based on the presence of certain types of atom.  Examples are `carbon molecular entities' and `lanthanoid molecular entities'. Classes qualify as subclasses of carbon molecular entities if they contain any atom of carbon, regardless of what other atoms they contain in addition.  Classes qualify as subclasses of lanthanoid molecular entities if they contain any of the lanthanoid group atoms.  As most complex molecular entities belong to several such classes, automation of this aspect of classification is obviously highly desirable. 

% Figure periodic table should contain the periodic table interface, an arrow from the header 'Lanthanoids', and then a screenshot of the search for is-a children with structures. 

Another form of definition by atomic composition is the definition of classes of molecular entity based on specifying the \textit{exclusive} atomic composition; this type of classification is dealt with below in the section \textit{\nameref{sec:molformula}}.


\subsubsection*{Chemical properties}

Straightforward chemical properties such as charge and unpaired electrons are used to define broad classes of molecules such as ion and radical. Aromaticity and saturation are other properties commonly found in class definitions. These also apply at a lower level of classification, such as `aromatic diazonium ion'.  


\subsubsection*{Cycles and ring arrangements}

Another element commonly used in class definitions is the number and arrangement of rings (cycles) in a ring system which is a part of the molecule. For example, the classes `ring assembly' and `polycyclic cage' both refer, in their definitions, to numbers and arrangements of rings in the molecule. Polycyclic cages are molecules which are composed entirely of cycles which are fused together in such a way as to form an overall cage-like structure.  Examples are the fullerenes, nanotubes, and small regular compounds such as cubane. 

Number and counts of rings

% Maybe a figure for polycyclic cages

ortho- and peri-fused compound: A polycyclic compound in which one ring contains two, and only two, atoms in common with each of two or more rings of a contiguous series of rings. Such compounds have n common faces and less than 2n common atoms.

ortho-fused compound: A polycyclic compound in which two rings have two, and only two, atoms in common. Such compounds have n common faces and 2n common atoms.


Related to the chemical properties from the previous section, the `cyclic' modifier is often treated as an overall property of the molecule and as a modifier for other class types. Consider: `cyclic ketone', `cyclic peptide', `cyclic ether', `cyclic tetrapyrrole', \ldots


\subsubsection*{Interesting parts}

Arguably the most prolific of methods for classifying chemical entities based on features of their structures is based on the presence or absence of specific parts.  Such parts may be the overall `skeleton' of the structure or they may be minor constituents. The skeleton is usually loosely defined as the major or most relevant part of the molecule, the `backbone' to which other groups are attached as decorations. 

For example, the class `metalloporphyrins' (see Figure~\ref{fig:Figuremetalpor}) is defined as any compound containing a porphyrin skeleton and a metal atom. 

Note that as the term is commonly used in chemistry, a skeleton is not always a straightforward substructure, since bond order (single or double) may vary, and bonds may even be added or removed while retaining the same skeleton. For example, \ldots

However, for our present purposes it will be sufficient to restrict the definition of skeleton to the stronger one which implies that the skeleton must be a substructure of the molecule it is a skeleton of.

%Ambiguity between classes with ``strict" definitions and the same name for classes representing X and all of its derivatives


% Maybe a figure


Parts may also be straightforward constituents in which there is no implication that the part is somehow maximal, as there is in the case of skeletons.  General parts are termed `groups' (which may be simple atoms). The number (count, cardinality) of such groups is also important.  For example, `tricarboxylic acid' can be defined as a compound containing exactly three carboxy groups. 

% Maybe a figure

The class definition may also specify the position at which a group (or set of groups) is attached to a skeleton. 

Some particularly problematic classes refer to the relative arrangement of parts / attachments within the whole molecule. 

A special case is the relative configuration of stereocentres. Chemical graphs can be specified for completely stereochemically specified entities, and for completely stereochemically unspecified entities, but relative configurations of stereogenic centers cannot be specified using traditional chemical graph representation formalisms. For example, `allothreonine' [rel-(2R,3R)-2-amino-3-hydroxybutanoic acid] and `threonine' [rel-(2R,3S)-2-amino-3-hydroxybutanoic acid] are compounds with a relative configuration of stereogenic centres, thus for which a graph cannot currently be drawn. Figure~\ref{fig:Figure12} illustrates completely stereochemically specified forms of threonine. What cannot be represented in the current graph formalism is a relative arrangement of these - if one is up, the other is down - or if one is down, the other is down - for example. 

% Maybe a figure



\subsubsection*{Structural formulae}
\label{sec:molformula}

Finally, an interesting, yet problematic to depict with existing graph-based tools, element of chemical class definitions, is that based on structural formula. For example, `alkane' is defined as ``an acyclic branched or unbranched hydrocarbon having the general formula $C_{n}H_{2n+2}$.'' 




%%
%%  Compare the above class types to the various available methods of automatic hierarchy construction in chemoinformatics
%%  Intended to also serve as a related work review on classification methods in chemoinformatics
%%
\subsection*{Algorithmic and statistical approaches to automatic hierarchy construction}
\label{sec:resultscheminf}

%% DUAN TO HELP WITH THIS SECTION

The interesting question is -- given the above types of chemical class definitions, and their implied hierarchical relationships, to what extent can the existing chemoinformatics approaches construct hierarchies in which the nodes correspond to classes defined in the above way? 

The basic units of chemoinformatics approaches are the substructure search, similarity search and graph isomorphism search.  Substructure search in particular can be used directly to address the construction of hierarchies by parts. 

SMARTS and R-GROUPS

Machine learning then has to be discussed.  In particular the way that machine learning allows application of certain types of hierarchy construction on a larger scale than exhaustive pairwise alignment?  

% SIMILARITY
Chemoinformatics solutions have been developed which facilitate classification of sets of chemical entities by automatic methods.  Such automatic classification systems are in common use in many areas of chemistry including drug discovery. One example of such a classification technique is classification based on \textit{hierarchical similarity clustering} \cite{barnard1992}.  In this technique, similarity between compounds is computed on a pairwise basis, and compounds are then grouped together in clusters of high mutual similarity. There are many different algorithms for computing similarity measures between compounds and for aggregating compounds into clusters based on pairwise similarity measures. Different algorithms lead to different classification results. 
%Limitations of this approach?  
One limitation is that most similarity measures, in order to be efficiently computable, compute only a subset of the total features of the molecules concerned, and local paths predominate over overall molecular structure. Thus, molecules may turn out to be quite similar according to such an algorithm while containing overall a rather different structure. Examples are xxxx and yyyy.  This problem is exacerbated for molecules of high structural regularity (e.g. polycyclic carbon compounds).  Nevertheless, similarity landscapes are of paramount importance in reducing the complexity and understanding the features of large collections of compounds. % Get Duan to check this section and the next. 

% SCAFFOLDS (PARTHOOD)
Another classification technique which is of particular importance in the pharmaceutical industry is classification based on substructures \cite{deshpande2005} or (relatedly) molecular scaffolding \cite{FindSomething}.  In this technique, substructures of the molecule are taken at increasing size, and molecules are classified based on the presence of such substructures.  Classification based on scaffolds form a hierarchy based on composition, and in pharmaceutical chemistry organic ring structures are usually taken as the backbone.  Scaffolds are then decorated with a variety of functional groups, and scaffolds may be combined to form scaffolds of increasing complexity. 
% This is DEFINITELY best illustrated with a diagram. 
Scaffolds often fix the overall structure of the molecule, which in bioactive and especially in synthetic chemistry has a large influence on the activity of the molecule in the biological system.  However, hierarchies based on scaffolding do not allow for the specification of overall properties of the molecule, and also does not allow for the annotation of similar aspects of molecules aside from their scaffolds. 
% Further limitations?

% The concept of scaffold may be as vague as skeleton;  it may be that X-containing entities are classified or instead that entities that are largely or mostly X are classified. If the latter, it would be very interesting to see how this is defined, as this can help us.  If the former, it is very similar to the approach which Leo and Michel have developed and reported on (cited later).


%%
%%  Compare the above class types to the various available methods of classification in chemical ontologies
%%  Intended to also serve as a related work review on chemical ontology
%%
\subsection*{Automatic classification in chemical ontologies}
\label{sec:resultschemontology}

%% DESPOINA TO HELP WITH THIS SECTION

Assuming a background in which full class definitions expressed in chemical ontologies enables automated reasoning both to check class membership and to construct appropriate hierarchies, to what extent do the logical facilities available to ontologies allow the construction of definitions according to the patterns outlined above? 

General comments about classification of chemicals in ontologies should go here, and then be specialised in the different relevant sections below addressing the specific types of 

This section could also be ordered differently: rather than ordering by chemical class type (requirement) it could be ordered by ontology technology / formalism. 

\subsubsection*{Atomic composition}

Robert Stevens describes an OWL-ification of the periodic table here: http://robertdavidstevens.wordpress.com/2011/05/05/an-ontology-of-the-periodic-table-using-electronic-structure-of-the-atom/



\subsubsection*{Interesting parts}

The representation of, and classification of, chemicals based on their interesting parts in the form of functional groups is probably the most well developed area of OWL-based chemical ontology at present. Dumontier et al. \cite{dumontier2007} developed an ontology of chemical functional groups encoded in OWL, which was able to be used to automatically link chemical entities defined by means of graphs to ontological classes defined by means of functional groups. They made use of a cheminformatics software application to extract functional groups from molecules with chemical structures specified in standard cheminformatics representation formalisms. While not as rich as the feature term representation described above, and far smaller than ChEBI ontology, the Dumontier representation allows powerful use to be made of the relatively compact knowledge base of functional groups in terms of the classification of arbitrary molecules in a defined hierarchy. Care, however, had to be taken to only encode the structures of the functional groups insofar as they were not cyclic. Along similar lines is the OWL encoding used by the Lipid Ontology \cite{chepelevlipids2011} for automatic classification of lipids. 


\subsubsection*{Cycles and ring arrangements}

What can currently be done to represent and reason over cycles in structured objects -- e.g. using DL safe rules? Advantages and limitations of various approaches. 

(Question that came up in presentation in Buffalo) To what extent can cardinality be used to create a basic cyclic model from OWL axioms?  e.g. stating that molecule has-part ONLY six atoms and that each atom is connected-to ONLY two other atoms, what models do you get? 
 

What is the ongoing research in the field of logical knowledge representation and reasoning that will allow such representation to a greater extent than before?  (Despoina's work)
 
An approach for the representation of the overall structure of highly regular polycyclic molecules is set out in \cite{hastings2011} using a combination of monadic second-order logic and ordinary OWL.  This approach has not yet been implemented in practice but shows promise for logical reasoning over features involving regularity in the overall structure of molecules, which features are not well able to be captured in general with parts-based approaches. 
  

\subsubsection*{Molecular formulae}

Closure axioms will work for `only'-type atomic composition (hydrocarbons); however, this does not suffice to express complex mathematical constraints such as are expressed in formulae such as CnH2n. 

This should also allow expressions in terms of absences of atoms of certain types (see Despoina's tech report). 



\section*{Discussion}

%% First we discuss the findings of the above evaluations for structural classification in chemistry.  Which approaches are best suited to which class types?  What are the strengths and weaknesses of chemoinformatics approaches and chemical ontology approaches?  What is the motivation for doing chemical ontology? 


%  Human knowledge and black box classification.
In contrast to the above methods of automatic hierarchy construction, chemical ontology consists in the specification of a hierarchy ``from the top down'', in the sense that the features of chemical classes are specified, and their members are assigned based on these features.  Chemical classes and the relationships between them may be specified to a greater or lesser level of detail, not restricted by what the algorithms for detecting similarity or substructures are able to detect. Creating such a hierarchy allows for the explicit representation of knowledge in the domain, knowledge which corresponds to the content of textbook chemistry and which can then be directly correlated with research reports in the literature as well as large-scale databases of chemical compounds. % Cite Expert-Systems? Dendral?
The explicit representation of knowledge in this fashion allows for the classification of edge cases (unusual classes) and cases which cannot be treated within the constraints of the available algorithmic tools. For example, xxx and yyy. 


% Importance of logic-based, specified classification. Machine classification just can't catch the edge cases.  Of course, machine classification is good where the features are small and they can be learned from a large collection of instances.  But manual classification gives a flexibility in defining features, even very large ones, or ones that span over a small number of examples but are nevertheless important. The most important thing is that the eventual classification (howsoever arrived at) is CORRECT, so that it does not lead to incorrect inferences and can be used to support science. 


Reasons that ontology and machine classification as currently used in chemoinformatics are distinct, mutually non-reducible exercises:  

1) NAMING of mid-level groupings. Where chemists have, for whatsoever historical tradition, already a name in use for a particular class of chemical entities, machine learned groupings may not discover quite the exact grouping that is intended to be referred to by that name. This leads to the situation where it is not possible, for example, to group together all the literature describing that category of chemicals, despite the fact that chemists think and communicate regularly in terms of such categories.  This can be compared to the scenario in chemistry education, where relevant groupings of chemical entities are often taught in chapter-specific units. %Need an example here!  Compare the output of a hierarchical clustering algorithm based on skeletons, to the content of a chemistry text book.  

2) Association of functions to mid-level groupings.  Grouping chemical structures by shared functions is one of the essential elements in chemoinformatics approaches.  If it is possible to group together all molecules which act against the same receptor, it is then possible to train predictive models based on this information.   %Cite something Willighagen-like here
Research in the sciences often examines groupings of chemical entities which exhibit shared behaviour in order to understand more about the mechanisms underlying that behaviour, as well. %Can cite that talk on the neural mechanisms of odor perception here, they used a principle component analysis on the structures of molecules which were known to be odorants. 
Having to extract the grouping that you are interested in manually from the database by doing a literature analysis yourself in every case is a labour-intensive task, and it is one that should be centralised so as to free up the resources of researchers for focusing on their primary research. 
Very importantly, this sort of information needs to be hierarchically organised, so that it is not repetitively described, and so that it can be grouped and clustered at different levels of aggregation depending on the needs of the individual researcher.  For some research purposes, one may be interested in the classification of all molecules which are odorants. For other purposes, one may be interested in only those which smell sweet or smell bitter. 

3) Those classes which represent structural features which are beyond the reach of our current chemoinformatics tools for automatically clustering and classifying our chemical structures. For example, fullerenes, cyclic peptides, and other examples. 

For these reasons, chemical ontology has a valid place alongside the more automatic methods for chemical classification.  However, this presents a challenge for tooling and for algorithm research, in that the logic-based ontology tools and algorithms need to work alongside chemoinformatics tools and algorithms. 


Harnessing the strengths of both approaches in complementary systems \ldots

%% What are the challenges in harnessing chemoinformatics from within a logical framework?  What are the needs on integrative approaches?

%% What will a hybrid system look like and what is it good for? 


Pre-computing and asserting all parts as a workaround to the problem with directly modelling structured objects: 
-- Explosion of asserted parts, and the parthood / OWL axioms challenge (if you precompute and assert all the parts). Not only parts, but also properties. Hence the need for Despoina's work so that graph structures can be exposed to the ontology directly. 
-- Substructure search and similarity search already well developed in chemoinformatics 





\section*{Conclusions}

summary of ongoing research and future directions

Artificial intelligence of the future and the need for hybrid systems in addition to the current and ongoing developments 

%%TODO: Check the papers which cite ChEBI for examples of how chemical ontologies (and especially ChEBI) are used!

-- describe applications of chemical ontology in text mining, data integration, automated reasoning, visualisation and biology (pathways?)

exciting applications of the future too: nanotechnology and biotechnology 



\section*{Methods}

\subsection*{Manipulating chemical structures}

-- ChEBI database
-- CDK
-- JChemPaint

\subsection*{Programmatic ontology creation}

-- OWL API
-- ChEBI ontology data model and the ChEBI maintenance suite, in particular the tooling for chemical structures
-- Conversion of relationships into all-some restrictions
-- InChI as annotations
-- How we create description graphs

\bigskip


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Author's contributions}
    Text for this section \ldots

    

%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgements}
  \ifthenelse{\boolean{publ}}{\small}{}
  Text for this section \ldots
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                  The Bibliography                       %%
%%                                                         %%              
%%  Bmc_article.bst  will be used to                       %%
%%  create a .BBL file for submission, which includes      %%
%%  XML structured for BMC.                                %%
%%  After submission of the .TEX file,                     %%
%%  you will be prompted to submit your .BBL file.         %%
%%                                                         %%
%%                                                         %%
%%  Note that the displayed Bibliography will not          %% 
%%  necessarily be rendered by Latex exactly as specified  %%
%%  in the online Instructions for Authors.                %% 
%%                                                         %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
{\ifthenelse{\boolean{publ}}{\footnotesize}{\small}
 \bibliographystyle{bmc_article}  % Style BST file
  \bibliography{strucontjcheminf} }     % Bibliography file (usually '*.bib' ) 

%%%%%%%%%%%

\ifthenelse{\boolean{publ}}{\end{multicols}}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Figures                       %%
%%                               %%
%% NB: this is for captions and  %%
%% Titles. All graphics must be  %%
%% submitted separately and NOT  %%
%% included in the Tex document  %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%
%% Do not use \listoffigures as most will included as separate files

\section*{Figures}
  \subsection*{Figure 1 - Sample figure title}
      A short description of the figure content
      should go here.

  \subsection*{Figure 2 - Sample figure title}
      Figure legend text.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Tables                        %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Use of \listoftables is discouraged.
%%
\section*{Tables}
  \subsection*{Table 1 - Sample table title}
    Here is an example of a \emph{small} table in \LaTeX\ using  
    \verb|\tabular{...}|. This is where the description of the table 
    should go. \par \mbox{}
    \par
    \mbox{
      \begin{tabular}{|c|c|c|}
        \hline \multicolumn{3}{|c|}{My Table}\\ \hline
        A1 & B2  & C3 \\ \hline
        A2 & ... & .. \\ \hline
        A3 & ..  & .  \\ \hline
      \end{tabular}
      }



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Additional Files              %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Additional Files}
  \subsection*{Additional file 1 --- Sample additional file title}
    Additional file descriptions text (including details of how to
    view the file, if it is in a non-standard format or the file extension).  This might
    refer to a multi-page table or a figure.

  \subsection*{Additional file 2 --- Sample additional file title}
    Additional file descriptions text.


\end{bmcformat}
\end{document}







